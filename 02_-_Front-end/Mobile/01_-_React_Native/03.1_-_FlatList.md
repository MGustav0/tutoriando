# Conexão com o Back-end

Considerarei o código do capítulo 1.

O _useState_ e o _useEffect_ possuem os mesmos conceitos e funcionalidades do ReactJS explicados no capítulo de ReactJS.

## Receber dados do back-end via FlatList

O FlatList é uma tag componente do React Native que carrega componentes em listas.

A diferença entre ele e a `<View>` é em performance, pois quando há muitos itens a serem mostrados a performance da _view_ cai em comparação ao _flatList_, pois ela mostra apenas os elementos em tela, o não visível não está renderizado, ao contrário da _view_. A renderização é feita em tempo real e à medida em que o usuário visualiza as informações, como se fosse uma lista virtualizada.

### Data

Recuperamos as informações do back-end via variável dentro do array de `useState([])`, no caso a _projects_, colocando-a em `data={projects}` dentro da tag componente `<FlatList />`, já declarada na importação.

Ele precisaa ser, necessariamente, um array (vetor).

### KeyExtrator

Possui o mesmo conceito da _key_ do ReactJS, mas diferentemente do ReactJs, o FlatList utiliza um _keyExtrator_ para identificar o objeto. Sua utilização é em forma de função que recebe o objeto, neste caso o _projeto_, e a sua identificação única, o _id_: `keyExtrator={project => project.id}`.

### RenderItem

O renderItem é uma função que irá renderizar os respectivos itens da lista em scroll infinito. Essa função consegue obter uma série de propriedades, como se é o primeiro item, se par ou ímpar, etc., neste caso receberemos cada um dos projetos, o objeto em si, de forma desestruturada `{item}`, podemos também converter seu nome: `{item: project}`.

```js
renderItem={({item: project}) => (
  <Text style={styles.project}>{project.title}</Text>
)}
```

### Código Completo

```js
import React from "react";
import { Text, StyleSheet, StatusBar, FlatList, SafeAreaView } from "react-native";

export default function App() {
  const [projects, setProjects] = useState([]);

  useEffect(({item}) => {
    api.get('projects'.then(response => {
    // Contém todos os projetos
    setProjects(response.data);
    });
  }, []);

  return (
    <>
      <StatusBar barStyle="light-content" backgroundColor="#7159c1"  />
      {/*A FlatList irá ocupar apenas a área visível do aparelho/aplicação. */}
      <SafeAreaView style={styles.container}>
        <FlatList
          data={projects}
          keyExtrator={project => project.id}
          renderItem={({item: project}) => (
            <Text style={styles.project}>{project.title}</Text>
          )}
        />
        </SafeAreaView>
    </>
  );
}

const styles = StyleSheet.create({
  // Pode ser qualquer nome.
  container: {
    flex: 1;
    // camelCase
    backgroundColor: '#7159c1'
  },

  title: {
    color: '#FFF',
    fontSize: 32
  }
})
```
